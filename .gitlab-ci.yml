stages:
  - test
  - deploy

pages:
  stage: deploy
  script:
    - mkdir -p public
    - if [ -d "docs" ]; then cp -r docs/* public/; fi
    - if [ -f "README.md" ]; then cp README.md public/; fi
    - echo "Creating branch-specific documentation structure"
    - echo "$CI_COMMIT_REF_NAME" > "public/branch-info.txt"
    - if [ ! -f "public/index.html" ]; then echo "<h1>Documentation for branch $CI_COMMIT_REF_NAME</h1><p>No index.html found in docs/ directory.</p>" > public/index.html; fi
    - echo "Documentation files copied to public directory:"
    - ls -la public/
  artifacts:
    paths:
      - public
    expire_in: 1 hour
  only:
    - main
    - ANALYTICAL
    - IMPLEMENTATION

validate_html:
  stage: test
  script:
    - echo "Validating HTML files..."
    - find . -name "*.html" -print
    - if [ -d "docs" ]; then find docs/ -name "*.html" -print; fi
  only:
    - main
    - ANALYTICAL
    - IMPLEMENTATION
